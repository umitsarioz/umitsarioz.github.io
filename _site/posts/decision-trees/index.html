<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Decision Trees Growing Your Way to Smarter Decisions" />
<meta property="og:locale" content="en" />
<meta name="description" content="Decision trees are a foundational tool in machine learning, offering a clear and intuitive method for both classification and regression tasks. This guide provides a detailed exploration of decision trees, from their core concepts to practical implementation." />
<meta property="og:description" content="Decision trees are a foundational tool in machine learning, offering a clear and intuitive method for both classification and regression tasks. This guide provides a detailed exploration of decision trees, from their core concepts to practical implementation." />
<link rel="canonical" href="http://localhost:4000/posts/decision-trees/" />
<meta property="og:url" content="http://localhost:4000/posts/decision-trees/" />
<meta property="og:site_name" content="Ümit Sarıöz" />
<meta property="og:image" content="http://localhost:4000/assets/img/ss/2023-07-08-decision-trees/first.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-07-08T00:00:00+03:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/ss/2023-07-08-decision-trees/first.jpg" />
<meta property="twitter:title" content="Decision Trees Growing Your Way to Smarter Decisions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-08T00:00:00+03:00","datePublished":"2023-07-08T00:00:00+03:00","description":"Decision trees are a foundational tool in machine learning, offering a clear and intuitive method for both classification and regression tasks. This guide provides a detailed exploration of decision trees, from their core concepts to practical implementation.","headline":"Decision Trees Growing Your Way to Smarter Decisions","image":"http://localhost:4000/assets/img/ss/2023-07-08-decision-trees/first.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/decision-trees/"},"url":"http://localhost:4000/posts/decision-trees/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Decision Trees | Growing Your Way to Smarter Decisions | Ümit Sarıöz
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ümit Sarıöz">
<meta name="application-name" content="Ümit Sarıöz">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script async src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  
    
        
          <!-- Display GoatCounter pageviews -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const pv = document.getElementById('pageviews');

    if (pv !== null) {
      const uri = location.pathname.replace(/\/$/, '');
      const url = `https://umitsarioz.goatcounter.com/counter/${encodeURIComponent(uri)}.json`;

      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          const count = data.count.replace(/\s/g, '');
          pv.innerText = new Intl.NumberFormat().format(count);
        })
        .catch((error) => {
          pv.innerText = '1';
        });
    }
  });
</script>

        
    
  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <!--
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/core/avatar_ai.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Ümit Sarıöz</a>
    <p class="site-subtitle fst-italic mb-0">AI & Tech. Bloge</p>
  </header>
-->
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/blog-timeline/" class="nav-link">
            <i class="fa-fw fa-fw fas fa-timeline"></i>
            

            <span>BLOG TIMELINE</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/projects/" class="nav-link">
            <i class="fa-fw fa-fw fas fa-code ml-xl-3 mr-xl-3 unloaded"></i>
            

            <span>PROJECTS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://www.linkedin.com/in/umitsarioz"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://github.com/umitsarioz"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['umitsariozz','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Decision Trees | Growing Your Way to Smarter Decisions</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Decision Trees | Growing Your Way to Smarter Decisions</h1>
    
      <p class="post-desc fw-light mb-4">Decision trees are a foundational tool in machine learning, offering a clear and intuitive method for both classification and regression tasks. This guide provides a detailed exploration of decision trees, from their core concepts to practical implementation.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1688763600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul  8, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/ss/2023-07-08-decision-trees/first.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/ss/2023-07-08-decision-trees/first.jpg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://www.linkedin.com/in/umitsarioz">Ümit Sarıöz</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          
            <span>
              <em id="pageviews">
                <i class="fas fa-spinner fa-spin small"></i>
              </em>
              views
            </span>
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2199 words"
>
  <em>12 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Decision Trees | Growing Your Way to Smarter Decisions</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Decision Trees | Growing Your Way to Smarter Decisions</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="introduction-to-decision-trees"><span class="me-2">Introduction to Decision Trees</span><a href="#introduction-to-decision-trees" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Decision trees are one of the most popular and widely used algorithms in machine learning, particularly for classification and regression tasks. They belong to the family of supervised learning algorithms and work by splitting the data into smaller subsets based on certain criteria. The result is a tree-like model of decisions that leads to a final output (label). This structure resembles the flow of decisions and their possible outcomes, hence the name <strong>“decision tree.”</strong></p>

<p><a href="/assets/img/ss/2023-07-08-decision-trees/dtree_gif1.webp" class="popup img-link  shimmer"><img src="/assets/img/ss/2023-07-08-decision-trees/dtree_gif1.webp" alt="dtree1" loading="lazy"></a>
<em>Dataset Split in a Decision Tree. Image by <a href="https://ml2gifs.substack.com/p/decision-trees">ml2gifs</a></em></p>

<p>The key idea behind decision trees is to select the best feature at each node to partition the data into subsets that are as homogenous as possible. This process is repeated recursively for each subset until the stopping criteria are met, either when the maximum depth is reached or when the data cannot be split any further.</p>

<p>Let’s say you are trying to decide what to wear. Your decision tree might ask: “Is it raining?” If yes, you grab an umbrella. If not, it might ask: “Is it cold?” and so on, until you have decided on your outfit for the day. In machine learning, decision trees do the same thing but with data, and instead of picking outfits, they are making predictions or classifications.</p>

<h2 id="why-should-you-care-about-decision-trees"><span class="me-2">Why Should You Care About Decision Trees?</span><a href="#why-should-you-care-about-decision-trees" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Ever tried explaining deep learning models to a non-techie friend? Yeah, not easy. But decision trees? They are a breeze to explain. You can see the decisions being made right in front of you, like following a flowchart. This makes them incredibly interpretable — you can understand exactly why the model made a particular prediction, which is super handy when you are working with stakeholders who demand transparency.</p>

<p>Another perk? Decision trees do not care about whether your data is on the same scale or even if it is numerical or categorical. Whether you are dealing with temperatures or zip codes, decision trees handle it all. Plus, they are great at dealing with complex, non-linear relationships. If there is a twisty path through the data, they will find it!</p>

<h2 id="when-to-use-decision-trees"><span class="me-2">When to Use Decision Trees?</span><a href="#when-to-use-decision-trees" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li><strong>You need something easy to explain:</strong> They are perfect for building models that both you and your team can understand and explain to others.</li>
  <li><strong>Your data has both numbers and categories:</strong> Trees handle both seamlessly, so you do not need to spend time converting everything to the same format.</li>
  <li><strong>You suspect there is a complex relationship hiding in your data:</strong> Trees will dig deep, splitting your data at every opportunity to find those hidden patterns.</li>
</ul>

<h2 id="overview-of-decision-trees"><span class="me-2">Overview of Decision Trees</span><a href="#overview-of-decision-trees" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/ss/2023-07-08-decision-trees/dtree_structure2.webp" class="popup img-link  shimmer"><img src="/assets/img/ss/2023-07-08-decision-trees/dtree_structure2.webp" alt="dtree2" loading="lazy"></a>
<em>Decision Tree Structure</em></p>

<p>In a decision tree, each decision(internal) node represents a test or condition on a feature (e.g., “Is Feature 1 greater than 5?”), each branch represents the outcome of that condition, and each leaf node represents a class label or final decision. The algorithm splits data by selecting the feature and threshold that provides the highest information gain (or lowest impurity).</p>

<p><u><b>Common Splitting Criteria:</b></u></p>

<blockquote>
  <ul>
    <li><strong>Gini Index:</strong> Measures the degree of probability of a particular feature being classified incorrectly when randomly chosen.</li>
  </ul>
</blockquote>

\[G(D) = 1 - \sum_{i=1}^c p_i^2\]

<blockquote>
  <ul>
    <li><strong>Entropy :</strong> Measures the amount of uncertainty or disorder in the data, aiming to reduce uncertainty with each split.</li>
  </ul>
</blockquote>

\[H(D) = - \sum_{i=1}^c p_i \log_2(p_i)\]

\[\text{Information Gain}(D, \text{split}) = H(D) - \left( \frac{|D_{\text{left}}|}{|D|} H(D_{\text{left}}) + \frac{|D_{\text{right}}|}{|D|} H(D_{\text{right}}) \right)\]

<p>In these formulas:</p>

<ul>
  <li>$p_i$​ represents the proportion of samples belonging to class ii.</li>
  <li>$c$ is the number of classes.</li>
  <li>$∣D_{left}∣$ and $∣D_{right}∣$ denote the number of samples in the left and right subsets, respectively.</li>
  <li>$H(D)$, $H(D_{left})$, and $H(D_{right})$ are the entropies or Gini impurities before and after the split.</li>
</ul>

<h2 id="pros-and-cons-of-decision-trees"><span class="me-2">Pros and Cons of Decision Trees</span><a href="#pros-and-cons-of-decision-trees" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h4 id="advantages"><span class="me-2">Advantages</span><a href="#advantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li><strong>Crystal clear:</strong> The decisions are laid out in a way that anyone can follow.</li>
  <li><strong>Flexibility:</strong> Trees work well with both numbers and categories, and you don’t need to do a ton of data prep beforehand.</li>
  <li><strong>Handles complexity:</strong> Trees can capture complex relationships that simpler models might miss.</li>
</ul>

<h4 id="disadvantages"><span class="me-2">Disadvantages</span><a href="#disadvantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li><strong>Overfitting danger:</strong> If you let the tree grow too deep, it starts to memorize the data rather than learn from it—kind of like a detective who sees conspiracies everywhere. Pruning the tree or limiting its depth helps prevent this.</li>
  <li><strong>A bit fickle:</strong> Small changes in the data can sometimes result in a totally different tree, which makes them less stable than other models.</li>
  <li><strong>Bias risk:</strong> Trees can sometimes get obsessed with features that have many levels or categories, ignoring others that might be more important.</li>
</ul>

<h2 id="building-a-decision-tree-from-scratch-step-by-step"><span class="me-2">Building a Decision Tree from Scratch: Step-by-Step</span><a href="#building-a-decision-tree-from-scratch-step-by-step" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Let’s dive into the algorithm to build a <a href="https://github.com/umitsarioz/algorithms-from-scratch/blob/main/decision_tree.py"> decision tree from scratch using the Python code</a> provided.</p>

<h3 id="1-initialize-the-tree"><span class="me-2">1. Initialize the Tree</span><a href="#1-initialize-the-tree" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>We start by creating a Node class that will represent each node in the decision tree. Each node will store important information such as the feature index, threshold for splitting, and pointers to left and right child nodes.In otherwords,  this node is like a fork in the road—it holds the feature we’re asking about and which way we’ll go based on the answer.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">feature_index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">condition_mark</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">score</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">information_gain</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">feature_index</span> <span class="o">=</span> <span class="n">feature_index</span>
        <span class="n">self</span><span class="p">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">condition_mark</span> <span class="o">=</span> <span class="n">condition_mark</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span>
        <span class="n">self</span><span class="p">.</span><span class="n">information_gain</span> <span class="o">=</span> <span class="n">information_gain</span>
        <span class="n">self</span><span class="p">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> 
</pre></td></tr></tbody></table></code></div></div>
<h3 id="2-stopping-conditions"><span class="me-2">2. Stopping Conditions</span><a href="#2-stopping-conditions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Before splitting the data, we check whether we should stop further splitting. This can happen if the data at the node is pure (contains only one class) or if the maximum depth or minimum samples condition is met.</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_should_stop</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="p">):</span>
    <span class="n">n_labels</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_labels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n_samples</span> <span class="o">&lt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">min_samples_count</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">max_depth</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">condition</span> 
</pre></td></tr></tbody></table></code></div></div>

<h3 id="3-splitting-the-data"><span class="me-2">3. Splitting the Data</span><a href="#3-splitting-the-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>At each node, we calculate potential splits for both categorical and numerical features. For numerical features, we use the median as a threshold, while for categorical features, we split by unique values.</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_get_potential_splits</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="n">potential_splits_all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># [feat_1, feat_2, ..., feat_n, labels]
</span>    <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
        <span class="n">data_feature</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">feature_idx</span><span class="p">]</span> 
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">data_feature</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">data_feature</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">bool</span><span class="p">):</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">data_feature</span><span class="p">)</span>
            <span class="n">condition_mark</span> <span class="o">=</span> <span class="sh">'</span><span class="s">==</span><span class="sh">'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">median</span><span class="p">(</span><span class="n">data_feature</span><span class="p">)]</span>
            <span class="n">condition_mark</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;=</span><span class="sh">'</span>
        <span class="n">potential_splits_all</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span><span class="sh">'</span><span class="s">idx</span><span class="sh">'</span><span class="p">:</span><span class="n">feature_idx</span><span class="p">,</span><span class="sh">'</span><span class="s">thresholds</span><span class="sh">'</span><span class="p">:</span><span class="n">thresholds</span><span class="p">,</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">:</span><span class="n">condition_mark</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">potential_splits_all</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="4-calculating-information-gain"><span class="me-2">4. Calculating Information Gain</span><a href="#4-calculating-information-gain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Next, we evaluate the information gain for each potential split. The information gain tells us how much uncertainty is reduced after splitting the data. We choose the split that provides the highest information gain.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_calculate_information_gain</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span> <span class="n">left_idxs</span><span class="p">,</span> <span class="n">right_idxs</span><span class="p">):</span>
    <span class="n">p_left</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">left_idxs</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">p_right</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_left</span> 
    <span class="n">weighted_impurity</span> <span class="o">=</span> <span class="n">p_left</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">left_idxs</span><span class="p">])</span> <span class="o">+</span> <span class="n">p_right</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">right_idxs</span><span class="p">])</span>
    <span class="n">parent_impurity</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">information_gain</span> <span class="o">=</span> <span class="n">parent_impurity</span> <span class="o">-</span> <span class="n">weighted_impurity</span>
    <span class="k">return</span> <span class="n">information_gain</span><span class="p">,</span> <span class="n">weighted_impurity</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="5-recursive-tree-building"><span class="me-2">5. Recursive Tree Building</span><a href="#5-recursive-tree-building" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Using the best split found, we recursively build the left and right subtrees until a stopping condition is met.</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_build_tree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">_should_stop</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="p">):</span>
        <span class="n">leaf_label</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_label_as_majority</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="nc">Node</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">leaf_label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">potential_splits</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_potential_splits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">bests</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_find_best_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">potential_splits</span><span class="p">)</span>
        <span class="n">left_tree</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_build_tree</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">left_idxs</span><span class="sh">'</span><span class="p">]],</span><span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">right_tree</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_build_tree</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">right_idxs</span><span class="sh">'</span><span class="p">]],</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="nc">Node</span><span class="p">(</span><span class="n">feature_index</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">feature_index</span><span class="sh">'</span><span class="p">],</span> <span class="n">threshold</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">threshold</span><span class="sh">'</span><span class="p">],</span>
                    <span class="n">condition_mark</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="n">left_tree</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right_tree</span><span class="p">,</span>
                    <span class="n">score</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">impurity</span><span class="sh">'</span><span class="p">],</span> <span class="n">criterion</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">criterion</span><span class="p">,</span>
                    <span class="n">information_gain</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">information_gain</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></div></div>
<h3 id="6-prediction"><span class="me-2">6. Prediction</span><a href="#6-prediction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>To make predictions, we traverse the tree recursively. Starting from the root, we follow the condition marks and thresholds until we reach a leaf node that holds the predicted label.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">node</span><span class="p">.</span><span class="n">label</span>
    <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">condition_mark</span> <span class="o">==</span> <span class="sh">'</span><span class="s">==</span><span class="sh">'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="n">node</span><span class="p">.</span><span class="n">feature_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">node</span><span class="p">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">left</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">right</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="n">node</span><span class="p">.</span><span class="n">feature_index</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="p">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">left</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">right</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="testing-the-decision-tree-on-real-datasets"><span class="me-2">Testing the Decision Tree on Real Datasets</span><a href="#testing-the-decision-tree-on-real-datasets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="/assets/img/ss/2023-07-08-decision-trees/iris-machinelearning.png" class="popup img-link  shimmer"><img src="/assets/img/ss/2023-07-08-decision-trees/iris-machinelearning.png" alt="irisdataset" loading="lazy"></a>
<em>Iris Dataset. Image by <a href="https://www.datacamp.com/tutorial/machine-learning-in-r">Datacamp</a></em></p>

<p>We can test our decision tree on well-known datasets such as the Iris dataset.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">test_with_iris_dataset</span><span class="p">():</span>
    <span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
    <span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="nf">load_iris</span><span class="p">()</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="nc">DecisionTree</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_samples_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="sh">'</span><span class="s">entropy</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">tree</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Test accuracy: </span><span class="si">{</span><span class="n">accuracy</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/ss/2023-07-08-decision-trees/iris_setosa.webp" class="popup img-link  shimmer"><img src="/assets/img/ss/2023-07-08-decision-trees/iris_setosa.webp" alt="irisdataset" loading="lazy"></a>
<em>Iris Dataset Decision Tree</em></p>

<h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Decision trees are powerful tools for both classification and regression tasks. They are easy to interpret and flexible, making them an excellent choice for many machine learning problems. However, care must be taken to prevent overfitting, which can be mitigated by using techniques such as pruning or by using ensemble methods like Random Forests or Gradient Boosting.</p>

<p>By implementing decision trees from scratch, we not only deepen our understanding of the algorithm but also gain the ability to customize it to better suit specific tasks.</p>

<blockquote class="prompt-tip">
  <p><a href="https://github.com/umitsarioz/algorithms-from-scratch/blob/main/decision_tree.py">Decision Tree Codes from Scratch Using the Python</a></p>
</blockquote>

<h2 id="full-code"><span class="me-2">Full Code</span><a href="#full-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span> 

<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">feature_index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">condition_mark</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">score</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">information_gain</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">feature_index</span> <span class="o">=</span> <span class="n">feature_index</span>
        <span class="n">self</span><span class="p">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">condition_mark</span> <span class="o">=</span> <span class="n">condition_mark</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span>
        <span class="n">self</span><span class="p">.</span><span class="n">information_gain</span> <span class="o">=</span> <span class="n">information_gain</span>
        <span class="n">self</span><span class="p">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> 
        
<span class="k">class</span> <span class="nc">DecisionTree</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">min_samples_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="sh">'</span><span class="s">entropy</span><span class="sh">'</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
        <span class="n">self</span><span class="p">.</span><span class="n">min_samples_count</span> <span class="o">=</span> <span class="n">min_samples_count</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">tree</span> <span class="o">=</span> <span class="bp">None</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">criterion</span> 
        <span class="n">self</span><span class="p">.</span><span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span> 
    
    <span class="k">def</span> <span class="nf">_should_stop</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="p">):</span>
        <span class="n">n_labels</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_labels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n_samples</span> <span class="o">&lt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">min_samples_count</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">max_depth</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">condition</span> 
    
    <span class="k">def</span> <span class="nf">_get_label_as_majority</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="n">labels</span><span class="p">,</span><span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">idx_max</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">_get_potential_splits</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="n">potential_splits_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># [feat_1,feat_2,...,feat_n,labels]
</span>        <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span> <span class="c1"># iterate over all features
</span>            <span class="n">data_feature</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">feature_idx</span><span class="p">]</span> 
    
            <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">data_feature</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">data_feature</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">bool</span><span class="p">):</span>
                <span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">data_feature</span><span class="p">)</span>
                <span class="n">condition_mark</span> <span class="o">=</span> <span class="sh">'</span><span class="s">==</span><span class="sh">'</span>
                <span class="n">potential_splits_all</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span><span class="sh">'</span><span class="s">idx</span><span class="sh">'</span><span class="p">:</span><span class="n">feature_idx</span><span class="p">,</span><span class="sh">'</span><span class="s">thresholds</span><span class="sh">'</span><span class="p">:</span><span class="n">thresholds</span><span class="p">,</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">:</span><span class="n">condition_mark</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">median</span><span class="p">(</span><span class="n">data_feature</span><span class="p">)]</span>
                <span class="n">condition_mark</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;=</span><span class="sh">'</span>
                <span class="n">potential_splits_all</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span><span class="sh">'</span><span class="s">idx</span><span class="sh">'</span><span class="p">:</span><span class="n">feature_idx</span><span class="p">,</span><span class="sh">'</span><span class="s">thresholds</span><span class="sh">'</span><span class="p">:</span><span class="n">thresholds</span><span class="p">,</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">:</span><span class="n">condition_mark</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">potential_splits_all</span>
    
    <span class="k">def</span> <span class="nf">_find_best_split</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">potential_splits</span><span class="p">):</span>
        <span class="n">bests</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">feature_index</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="sh">'</span><span class="s">threshold</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                   <span class="sh">'</span><span class="s">information_gain</span><span class="sh">'</span><span class="p">:</span><span class="o">-</span><span class="nf">float</span><span class="p">(</span><span class="sh">"</span><span class="s">inf</span><span class="sh">"</span><span class="p">),</span><span class="sh">'</span><span class="s">impurity</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="sh">'</span><span class="s">left_idxs</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="sh">'</span><span class="s">right_idxs</span><span class="sh">'</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        
        <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">potential_splits</span><span class="p">:</span>
            <span class="n">feature_idx</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">"</span><span class="s">idx</span><span class="sh">"</span><span class="p">]</span>
            <span class="n">thresholds</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">"</span><span class="s">thresholds</span><span class="sh">"</span><span class="p">]</span>
            <span class="n">condition_mark</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">"</span><span class="s">condition_mark</span><span class="sh">"</span><span class="p">]</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">feature_idx</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">condition_mark</span> <span class="o">==</span> <span class="sh">'</span><span class="s">==</span><span class="sh">'</span><span class="p">:</span> <span class="c1"># for categorical features 
</span>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">x</span> <span class="o">==</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">features</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># for numerical features 
</span>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">features</span><span class="p">])</span>
                    
                <span class="n">left_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">cond</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">right_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="o">~</span><span class="n">cond</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">information_gain</span><span class="p">,</span><span class="n">impurity</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_information_gain</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">left_idxs</span><span class="p">,</span> <span class="n">right_idxs</span><span class="p">)</span>  
                <span class="k">if</span> <span class="n">information_gain</span> <span class="o">&gt;</span> <span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">information_gain</span><span class="sh">'</span><span class="p">]:</span>
                    <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">feature_index</span><span class="sh">'</span><span class="p">:</span><span class="n">feature_idx</span><span class="p">,</span><span class="sh">'</span><span class="s">threshold</span><span class="sh">'</span><span class="p">:</span><span class="n">threshold</span><span class="p">,</span>
                           <span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">:</span><span class="n">condition_mark</span><span class="p">,</span><span class="sh">'</span><span class="s">information_gain</span><span class="sh">'</span><span class="p">:</span><span class="n">information_gain</span><span class="p">,</span><span class="sh">'</span><span class="s">impurity</span><span class="sh">'</span><span class="p">:</span><span class="n">impurity</span><span class="p">,</span>
                           <span class="sh">'</span><span class="s">left_idxs</span><span class="sh">'</span><span class="p">:</span><span class="n">left_idxs</span><span class="p">,</span><span class="sh">'</span><span class="s">right_idxs</span><span class="sh">'</span><span class="p">:</span><span class="n">right_idxs</span><span class="p">}</span>
                    <span class="n">bests</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">dct</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">bests</span> 
                   
                    
    <span class="k">def</span> <span class="nf">_calculate_information_gain</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span> <span class="n">left_idxs</span><span class="p">,</span> <span class="n">right_idxs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">left_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nf">len</span><span class="p">(</span><span class="n">right_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="n">information_gain</span><span class="p">,</span> <span class="n">weighted_impurity</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> 
            <span class="k">return</span> <span class="n">information_gain</span><span class="p">,</span> <span class="n">weighted_impurity</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_left</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">left_idxs</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">p_right</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_left</span> 

            <span class="n">weighted_impurity</span> <span class="o">=</span> <span class="n">p_left</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">left_idxs</span><span class="p">])</span> <span class="o">+</span> <span class="n">p_right</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">right_idxs</span><span class="p">])</span>
            <span class="n">parent_impurity</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

            <span class="n">information_gain</span> <span class="o">=</span> <span class="n">parent_impurity</span> <span class="o">-</span> <span class="n">weighted_impurity</span>
            <span class="k">return</span> <span class="n">information_gain</span><span class="p">,</span> <span class="n">weighted_impurity</span>
    
    <span class="k">def</span> <span class="nf">_calculate_impurity</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">labels</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">criterion</span> <span class="o">==</span> <span class="sh">'</span><span class="s">gini</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_gini</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">criterion</span> <span class="o">==</span> <span class="sh">'</span><span class="s">entropy</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_entropy</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">Criterion must be </span><span class="sh">'</span><span class="s">gini</span><span class="sh">'</span><span class="s"> or </span><span class="sh">'</span><span class="s">entropy</span><span class="sh">'</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">_calculate_entropy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span><span class="n">counts</span><span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">probs</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">log2</span><span class="p">(</span><span class="n">probs</span><span class="o">+</span><span class="mf">1e-9</span><span class="p">))</span><span class="c1"># Add small value to avoid log(0)
</span>        <span class="k">return</span> <span class="n">score</span> 
    
    <span class="k">def</span> <span class="nf">_calculate_gini</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span><span class="n">counts</span><span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">power</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> 
        <span class="k">return</span> <span class="n">score</span> 
    
    <span class="k">def</span> <span class="nf">_build_tree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">_should_stop</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">depth</span><span class="p">):</span>
            <span class="n">leaf_label</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_label_as_majority</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="nc">Node</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">leaf_label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">potential_splits</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_potential_splits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">bests</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_find_best_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">potential_splits</span><span class="p">)</span>

            <span class="n">left_tree</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_build_tree</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">left_idxs</span><span class="sh">'</span><span class="p">]],</span><span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">right_tree</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_build_tree</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">right_idxs</span><span class="sh">'</span><span class="p">]],</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="nc">Node</span><span class="p">(</span><span class="n">feature_index</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">feature_index</span><span class="sh">'</span><span class="p">],</span><span class="n">threshold</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">threshold</span><span class="sh">'</span><span class="p">],</span>
                        <span class="n">condition_mark</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">condition_mark</span><span class="sh">'</span><span class="p">],</span><span class="n">left</span><span class="o">=</span><span class="n">left_tree</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="n">right_tree</span><span class="p">,</span>
                        <span class="n">score</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">impurity</span><span class="sh">'</span><span class="p">],</span><span class="n">criterion</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">criterion</span><span class="p">,</span>
                        <span class="n">information_gain</span><span class="o">=</span><span class="n">bests</span><span class="p">[</span><span class="sh">'</span><span class="s">information_gain</span><span class="sh">'</span><span class="p">])</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">column_stack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_build_tree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
    
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">)</span> <span class="k">for</span> <span class="n">data_point</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">predictions</span>

    <span class="c1"># Traverse the tree recursively to predict the label
</span>    <span class="k">def</span> <span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># If we're at a leaf, return the label
</span>            <span class="k">return</span> <span class="n">node</span><span class="p">.</span><span class="n">label</span>
        
        <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">condition_mark</span> <span class="o">==</span> <span class="sh">'</span><span class="s">==</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="n">node</span><span class="p">.</span><span class="n">feature_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">node</span><span class="p">.</span><span class="n">threshold</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">left</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="n">node</span><span class="p">.</span><span class="n">feature_index</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="p">.</span><span class="n">threshold</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">left</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_traverse_tree</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span> <span class="n">node</span><span class="p">.</span><span class="n">right</span><span class="p">)</span>
            
            
<span class="k">def</span> <span class="nf">test_with_iris_dataset</span><span class="p">():</span>
    <span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
    <span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="nf">load_iris</span><span class="p">()</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">target</span>

    <span class="c1"># Split the data into training and testing sets
</span>    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="nc">DecisionTree</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_samples_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="sh">'</span><span class="s">gini</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">tree</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Make predictions on the test set
</span>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Calculate accuracy
</span>    <span class="n">accuracy</span> <span class="o">=</span> <span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Gini Test accuracy: </span><span class="si">{</span><span class="n">accuracy</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Create and train the decision tree with 'entropy' criterion
</span>    <span class="n">tree_entropy</span> <span class="o">=</span> <span class="nc">DecisionTree</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_samples_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="sh">'</span><span class="s">entropy</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">tree_entropy</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Make predictions on the test set using entropy criterion
</span>    <span class="n">y_pred_entropy</span> <span class="o">=</span> <span class="n">tree_entropy</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Calculate accuracy
</span>    <span class="n">accuracy_entropy</span> <span class="o">=</span>  <span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_entropy</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Entropy Test accuracy: </span><span class="si">{</span><span class="n">accuracy_entropy</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/algorithms/"
            class="post-tag no-text-decoration"
          >algorithms</a>
        
          <a
            href="/tags/machine-learning/"
            class="post-tag no-text-decoration"
          >machine-learning</a>
        
          <a
            href="/tags/supervised-learning/"
            class="post-tag no-text-decoration"
          >supervised-learning</a>
        
          <a
            href="/tags/from-scratch/"
            class="post-tag no-text-decoration"
          >from-scratch</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Decision%20Trees%20%7C%20Growing%20Your%20Way%20to%20Smarter%20Decisions%20-%20%C3%9Cmit%20Sar%C4%B1%C3%B6z&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdecision-trees%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdecision-trees%2F&text=Decision%20Trees%20%7C%20Growing%20Your%20Way%20to%20Smarter%20Decisions%20-%20%C3%9Cmit%20Sar%C4%B1%C3%B6z" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fdecision-trees%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/nlp-101/">Getting Started with NLP | A Journey from RNNs to Transformers</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/singular-value-decompositon/">Singular Value Decomposition (SVD)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/install-apache-cassandra/">Guide to Installing Apache Cassandra on Ubuntu</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/jupyter-lab/">Jupyter Lab Installation on Ubuntu</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/apache_kafka/">Apache Kafka on Ubuntu | Architecture, Installation, and Usage</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning/">machine-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/from-scratch/">from-scratch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithms/">algorithms</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/supervised-learning/">supervised-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/basics/">basics</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tutorials/">tutorials</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/big-data/">big-data</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/setup/">setup</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/convolutional-neural-networks/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1695070800"
  data-df="ll"
  
>
  Sep 19, 2023
</time>

              <h4 class="pt-0 my-2">Deep Dive into Convolutional Neural Networks (CNNs)</h4>
              <div class="text-muted">
                <p>Convolutional Neural Networks (CNNs) are fundamental to deep learning, revolutionizing computer vision tasks like image recognition and object detection by enhancing how machines interpret visual d...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/naive-bayes/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1681765200"
  data-df="ll"
  
>
  Apr 18, 2023
</time>

              <h4 class="pt-0 my-2">Naive Bayes Simplified | From Theory to Code</h4>
              <div class="text-muted">
                <p>Naive Bayes is a family of probabilistic classifiers based on Bayes&#39; theorem with the &quot;naive&quot; assumption that features are conditionally independent given the class label. Despite this simplificati...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/k-nearest-neighbours-from-scratch/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1680728400"
  data-df="ll"
  
>
  Apr  6, 2023
</time>

              <h4 class="pt-0 my-2">Your Friendly Neighborhood Algorithm is KNN</h4>
              <div class="text-muted">
                <p>The k-Nearest Neighbors (KNN) algorithm is like asking your friends for advice based on who’s closest to you. It figures out your data&#39;s category by looking at its nearest neighbors and deciding wh...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/apriori/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Apriori Algorithm from Scratch | Building a Netflix Film Recommendation System</p>
    </a>
  

  
    <a
      href="/posts/classification-metrics/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Classification Evaluation Metrics in Machine Learning</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://www.linkedin.com/in/umitsarioz">Ümit Sarıöz</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning/">machine-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/from-scratch/">from-scratch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithms/">algorithms</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/supervised-learning/">supervised-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/basics/">basics</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tutorials/">tutorials</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/big-data/">big-data</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/setup/">setup</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

